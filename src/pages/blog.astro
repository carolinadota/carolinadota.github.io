---
import Layout from '../layouts/Layout.astro';

// Get all blog posts
const posts = await Astro.glob('../posts/*.md');

// Sort posts by date (newest first)
const sortedPosts = posts.sort((a, b) => {
  const dateA = new Date(a.frontmatter.date);
  const dateB = new Date(b.frontmatter.date);
  return dateB.getTime() - dateA.getTime();
});

// Format date as MM-DD-YYYY
function formatDate(dateString: string) {
  const date = new Date(dateString);
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  const year = date.getFullYear();
  return `${month}-${day}-${year}`;
}

// Convert title to slug
function titleToSlug(title: string) {
  return title
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, '-')
    .replace(/^-+|-+$/g, '');
}
---

<Layout title="Blog - Carolina Dota" description="Blog posts and articles by Carolina Dota">
  <h1>Latest Posts</h1>
  
  <ul class="post-list">
    {sortedPosts.map(post => (
      <li>
        <span class="post-date">{formatDate(post.frontmatter.date)}</span>
        <span class="separator"> - </span>
        <a href={`/blog/${titleToSlug(post.frontmatter.title)}`}>
          {post.frontmatter.title}
        </a>
      </li>
    ))}
  </ul>
</Layout>

<style>
  h1 {
    margin-bottom: 2rem;
  }
  
  .post-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  
  .post-list li {
    margin: 0.75rem 0;
    line-height: 1.6;
  }
  
  .post-date {
    color: #e0e0e0;
  }
  
  .separator {
    color: #e0e0e0;
  }
  
  .post-list a {
    color: #e0e0e0;
    text-decoration: none;
  }
  
  .post-list a:hover {
    color: #ffffff;
    text-decoration: underline;
  }
</style>